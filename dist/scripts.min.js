document.documentElement.classList.remove("no-js");const hydrationQueue={critical:[],important:[],nonessential:[]};function queueHydration(func,priority="important"){hydrationQueue[priority].push(func)}document.addEventListener("DOMContentLoaded",function(){console.log("DOM loaded and scripts running");hydrationQueue.critical.forEach(func=>func());setTimeout(()=>{hydrationQueue.important.forEach(func=>func());console.log("Important features hydrated")},100);if("requestIdleCallback"in window){requestIdleCallback(()=>{hydrationQueue.nonessential.forEach(func=>func());console.log("Non-essential features hydrated")},{timeout:2e3})}else{setTimeout(()=>{hydrationQueue.nonessential.forEach(func=>func());console.log("Non-essential features hydrated")},2e3)}});queueHydration(()=>{const header=document.querySelector(".header");window.addEventListener("scroll",()=>{if(window.scrollY>50){header.classList.add("scrolled")}else{header.classList.remove("scrolled")}})},"critical");queueHydration(()=>{if("IntersectionObserver"in window){const animatedElements=document.querySelectorAll(".animate-item");const animationObserver=new IntersectionObserver(entries=>{entries.forEach(entry=>{if(entry.isIntersecting){entry.target.classList.add("visible");animationObserver.unobserve(entry.target)}})},{threshold:.15,rootMargin:"0px 0px -10% 0px"});animatedElements.forEach(element=>{animationObserver.observe(element)})}else{const animatedElements=document.querySelectorAll(".animate-item");const animateOnScroll=()=>{const triggerBottom=window.innerHeight*.85;animatedElements.forEach(element=>{const elementTop=element.getBoundingClientRect().top;if(elementTop<triggerBottom){element.classList.add("visible")}})};animateOnScroll();window.addEventListener("scroll",animateOnScroll)}});queueHydration(()=>{if(typeof gsap==="undefined"){console.warn("GSAP not loaded yet");return}try{gsap.registerPlugin(ScrollTrigger);gsap.from(".hero-title",{opacity:0,y:30,duration:1,delay:.2,ease:"power3.out"});gsap.from(".hero-subtitle",{opacity:0,y:30,duration:1,delay:.4,ease:"power3.out"});gsap.from(".hero-description",{opacity:0,y:30,duration:1,delay:.6,ease:"power3.out"});gsap.from(".hero-buttons",{opacity:0,y:30,duration:1,delay:.8,ease:"power3.out"});gsap.from(".image-wrapper",{opacity:0,scale:.9,duration:1.2,delay:.3,ease:"power3.out"});gsap.from(".accent-shape",{opacity:0,scale:0,rotation:-45,duration:1.5,delay:.5,ease:"elastic.out(1, 0.5)"});gsap.from(".experience-badge",{opacity:0,x:-30,duration:1,delay:1,ease:"back.out(1.7)"});gsap.utils.toArray(".section").forEach(section=>{const sectionTitle=section.querySelector(".section-title");if(sectionTitle){gsap.from(sectionTitle,{scrollTrigger:{trigger:section,start:"top 80%"},opacity:0,y:30,duration:.8,ease:"power3.out"})}gsap.from(section.querySelectorAll(".animate-item:not(.visible)"),{scrollTrigger:{trigger:section,start:"top 70%"},opacity:0,y:30,duration:.8,stagger:.2,ease:"power3.out"})})}catch(error){console.error("Error initializing GSAP animations:",error)}},"nonessential");queueHydration(()=>{const serviceCards=document.querySelectorAll(".service-card-inner");if(typeof gsap!=="undefined"&&serviceCards.length>0){serviceCards.forEach(card=>{const icon=card.querySelector(".service-icon");if(!icon)return;card.addEventListener("mouseenter",()=>{gsap.to(icon,{rotate:10,scale:1.1,backgroundColor:"var(--color-primary)",color:"var(--color-dark)",duration:.3,ease:"back.out(1.7)"})});card.addEventListener("mouseleave",()=>{gsap.to(icon,{rotate:0,scale:1,backgroundColor:"rgba(253, 216, 53, 0.1)",color:"var(--color-primary)",duration:.3,ease:"power3.out"})})})}},"nonessential");queueHydration(()=>{const allWrapperElements=document.querySelectorAll(".service-card-wrapper, .testimonial-card-wrapper, .timeline-content-wrapper, .video-testimonial-wrapper");if(allWrapperElements.length===0)return;const isMobile=window.innerWidth<=768;if(!isMobile){const throttle=(func,limit)=>{let inThrottle;return function(){const args=arguments;const context=this;if(!inThrottle){func.apply(context,args);inThrottle=true;setTimeout(()=>inThrottle=false,limit)}}};let ticking=false;let lastMouseX=0;let lastMouseY=0;const handleMouseMove=e=>{lastMouseX=e.clientX;lastMouseY=e.clientY;if(!ticking){window.requestAnimationFrame(()=>{updateGradients(lastMouseX,lastMouseY);ticking=false});ticking=true}};const updateGradients=throttle((mouseX,mouseY)=>{allWrapperElements.forEach(element=>{const rect=element.getBoundingClientRect();if(rect.bottom<0||rect.top>window.innerHeight||rect.right<0||rect.left>window.innerWidth){return}const centerX=rect.left+rect.width/2;const centerY=rect.top+rect.height/2;const deltaX=mouseX-centerX;const deltaY=mouseY-centerY;const distance=Math.sqrt(deltaX*deltaX+deltaY*deltaY);const threshold=300;if(distance<threshold){const x=mouseX-rect.left;const y=mouseY-rect.top;const opacity=1-distance/threshold;element.style.setProperty("--x",`${x}px`);element.style.setProperty("--y",`${y}px`);element.style.setProperty("--opacity",opacity.toString())}else{element.style.setProperty("--opacity","0")}})},16);document.addEventListener("mousemove",handleMouseMove,{passive:true})}else{const animatedElements=new Set;const observer=new IntersectionObserver(entries=>{entries.forEach((entry,index)=>{if(entry.isIntersecting&&!animatedElements.has(entry.target)){animatedElements.add(entry.target);setTimeout(()=>{entry.target.classList.add("mobile-glow-active");setTimeout(()=>{entry.target.classList.remove("mobile-glow-active");setTimeout(()=>{animatedElements.delete(entry.target)},5e3)},4e3)},index*200)}})},{threshold:.2,rootMargin:"0px"});allWrapperElements.forEach(element=>{observer.observe(element)})}},"important");queueHydration(()=>{const menuToggle=document.querySelector(".menu-toggle");const navList=document.querySelector(".nav-list");if(menuToggle&&navList){menuToggle.addEventListener("click",()=>{navList.classList.toggle("active");menuToggle.classList.toggle("active")});document.querySelectorAll(".nav-link").forEach(link=>{link.addEventListener("click",()=>{if(navList.classList.contains("active")){navList.classList.remove("active");menuToggle.classList.remove("active")}})})}},"critical");queueHydration(()=>{document.querySelectorAll('a[href^="#"]:not([data-calendly])').forEach(anchor=>{anchor.addEventListener("click",function(e){const href=this.getAttribute("href");if(href==="#")return;e.preventDefault();const targetId=href;const targetElement=document.querySelector(targetId);if(targetElement){const headerOffset=document.querySelector(".header").offsetHeight;const targetPosition=targetElement.getBoundingClientRect().top+window.pageYOffset;const offsetPosition=targetPosition-headerOffset;window.scrollTo({top:offsetPosition,behavior:"smooth"})}})})},"important");queueHydration(()=>{const heroImage=document.querySelector(".hero-image-container");if(heroImage){let isThrottled=false;window.addEventListener("mousemove",e=>{if(isThrottled)return;isThrottled=true;window.requestAnimationFrame(()=>{const xValue=(e.clientX-window.innerWidth/2)/30;const yValue=(e.clientY-window.innerHeight/2)/30;heroImage.style.transform=`translate(${xValue}px, ${yValue}px)`;setTimeout(()=>{isThrottled=false},16)})})}},"nonessential");queueHydration(()=>{const animationContainer=document.getElementById("gsap-animation");if(animationContainer&&typeof gsap!=="undefined"){const circle=animationContainer.querySelector(".anim-circle");const square=animationContainer.querySelector(".anim-square");const triangle=animationContainer.querySelector(".anim-triangle");if(circle&&square&&triangle){gsap.to(circle,{scale:1.2,duration:2,repeat:-1,yoyo:true,ease:"power1.inOut"});gsap.to(square,{rotation:360,duration:4,repeat:-1,ease:"none"});gsap.to(triangle,{y:-20,duration:1.5,repeat:-1,yoyo:true,ease:"power1.inOut"})}}},"nonessential");queueHydration(()=>{const scrollToTop=document.querySelector(".scroll-to-top");if(scrollToTop){scrollToTop.addEventListener("click",e=>{e.preventDefault();window.scrollTo({top:0,behavior:"smooth"})});const toggleScrollButton=()=>{if(window.scrollY>500){scrollToTop.classList.add("visible")}else{scrollToTop.classList.remove("visible")}};toggleScrollButton();window.addEventListener("scroll",toggleScrollButton,{passive:true})}},"important");queueHydration(()=>{const modalManager={activeModals:[],isHandlingHistory:false,openModal:function(modalId,modalElement,closeCallback){const scrollPosition=window.scrollY;if(!this.isHandlingHistory){window.history.pushState({action:"openModal",modalId:modalId,scrollPosition:scrollPosition},"",window.location.pathname+window.location.search+"#"+modalId)}this.activeModals.push({id:modalId,element:modalElement,closeCallback:closeCallback,scrollPosition:scrollPosition});console.log("Modal opened:",modalId,"Current stack:",this.activeModals.map(m=>m.id))},closeModal:function(modalId,skipHistory=false){const modalIndex=this.activeModals.findIndex(m=>m.id===modalId);if(modalIndex!==-1){const modal=this.activeModals[modalIndex];if(typeof modal.closeCallback==="function"){modal.closeCallback()}this.activeModals.splice(modalIndex,1);if(!this.isHandlingHistory&&!skipHistory){window.history.back()}if(this.activeModals.length===0&&modal.scrollPosition!==undefined){setTimeout(()=>{window.scrollTo(0,modal.scrollPosition)},0)}console.log("Modal closed:",modalId,"Remaining stack:",this.activeModals.map(m=>m.id))}},handleHistoryChange:function(event){this.isHandlingHistory=true;try{if(!event.state||!event.state.action){[...this.activeModals].forEach(modal=>{this.closeModal(modal.id,true)})}else if(event.state.action==="openModal"){const{modalId}=event.state;while(this.activeModals.length>0&&this.activeModals[this.activeModals.length-1].id!==modalId){this.closeModal(this.activeModals[this.activeModals.length-1].id,true)}if(event.state.scrollPosition!==undefined){setTimeout(()=>{window.scrollTo(0,event.state.scrollPosition)},0)}}}finally{this.isHandlingHistory=false}},initialize:function(){window.addEventListener("popstate",this.handleHistoryChange.bind(this));if(window.location.hash){const modalId=window.location.hash.substring(1)}}};modalManager.initialize();window.modalManager=modalManager},"critical");queueHydration(()=>{const calendlyButtons=document.querySelectorAll("[data-calendly]");const calendlyModal=document.getElementById("calendlyModal");const calendlyModalClose=document.getElementById("calendlyModalClose");const calendlyContainer=document.getElementById("calendlyContainer");if(!calendlyButtons.length||!calendlyModal||!calendlyModalClose||!calendlyContainer)return;let currentModalId=null;let defaultCalendlyURL=null;if(calendlyButtons.length>0){defaultCalendlyURL=calendlyButtons[0].getAttribute("data-calendly")}const generateCalendlyId=()=>`calendly-modal-${Math.floor(Math.random()*1e6)}`;function preloadCalendly(){if(!window.calendlyLoaded){const calendlyCSS=document.createElement("link");calendlyCSS.rel="stylesheet";calendlyCSS.href="https://assets.calendly.com/assets/external/widget.css";document.head.appendChild(calendlyCSS);const calendlyScript=document.createElement("script");calendlyScript.src="https://assets.calendly.com/assets/external/widget.js";calendlyScript.async=true;calendlyScript.onload=()=>{console.log("Calendly resources preloaded");window.calendlyLoaded=true;if(defaultCalendlyURL){const preloadContainer=document.createElement("div");preloadContainer.style.position="absolute";preloadContainer.style.left="-9999px";preloadContainer.style.height="1px";preloadContainer.style.width="1px";preloadContainer.style.overflow="hidden";preloadContainer.innerHTML=`<div class="calendly-inline-widget" data-url="${defaultCalendlyURL}?hide_event_type_details=1&hide_gdpr_banner=1"></div>`;document.body.appendChild(preloadContainer);setTimeout(()=>{document.body.removeChild(preloadContainer)},5e3)}};document.body.appendChild(calendlyScript);window.calendlyLoaded="loading"}}function openCalendlyModal(calendlyURL){const modalId=generateCalendlyId();currentModalId=modalId;calendlyContainer.innerHTML=`
      <div class="calendly-inline-widget" 
           data-url="${calendlyURL}?hide_event_type_details=1&hide_gdpr_banner=1" 
           style="min-width:320px;height:750px;"></div>
    `;calendlyModal.classList.add("active");document.body.style.overflow="hidden";if(window.Calendly){window.Calendly.initInlineWidget({url:calendlyURL,parentElement:calendlyContainer.querySelector(".calendly-inline-widget"),prefill:{},utm:{}})}window.modalManager.openModal(modalId,calendlyModal,closeCalendlyModal);attachSwipeToClose(calendlyModal,function(){window.modalManager.closeModal(modalId)});return modalId}function closeCalendlyModal(){calendlyModal.classList.remove("active");document.body.style.overflow="";setTimeout(()=>{if(currentModalId){calendlyContainer.innerHTML="";currentModalId=null}},300)}calendlyButtons.forEach(btn=>{btn.addEventListener("click",function(e){e.preventDefault();const calendlyURL=btn.getAttribute("data-calendly");if(!calendlyURL)return;if(!window.calendlyLoaded||window.calendlyLoaded==="loading"){calendlyContainer.innerHTML=`
          <div class="calendly-loading" style="display:flex;align-items:center;justify-content:center;height:100%;">
            <div style="text-align:center;">
              <div class="loading-spinner" style="margin:0 auto 20px;width:50px;height:50px;border:3px solid rgba(255,255,255,0.1);border-radius:50%;border-top-color:var(--color-primary);animation:spin 1s linear infinite;"></div>
              <p>Loading calendar...</p>
            </div>
          </div>
          <style>
            @keyframes spin {
              to { transform: rotate(360deg); }
            }
          </style>
        `;calendlyModal.classList.add("active");document.body.style.overflow="hidden";const preloadScript=document.createElement("script");preloadScript.src="https://assets.calendly.com/assets/external/widget.js";preloadScript.async=true;preloadScript.onload=()=>{window.calendlyLoaded=true;openCalendlyModal(calendlyURL)};document.body.appendChild(preloadScript)}else{openCalendlyModal(calendlyURL)}})});calendlyModalClose.addEventListener("click",()=>{const activeCalendlyModal=window.modalManager.activeModals.find(modal=>modal.element===calendlyModal);if(activeCalendlyModal){window.modalManager.closeModal(activeCalendlyModal.id)}});calendlyModal.addEventListener("click",e=>{if(e.target===calendlyModal){const activeCalendlyModal=window.modalManager.activeModals.find(modal=>modal.element===calendlyModal);if(activeCalendlyModal){window.modalManager.closeModal(activeCalendlyModal.id)}}});document.addEventListener("keydown",e=>{if(e.key==="Escape"&&calendlyModal.classList.contains("active")){const activeCalendlyModal=window.modalManager.activeModals.find(modal=>modal.element===calendlyModal);if(activeCalendlyModal){window.modalManager.closeModal(activeCalendlyModal.id)}}});if(typeof requestIdleCallback!=="undefined"){requestIdleCallback(()=>preloadCalendly(),{timeout:3e3})}else{setTimeout(preloadCalendly,3e3)}},"important");queueHydration(()=>{const videoWrappers=document.querySelectorAll(".video-wrapper");const videoModal=document.getElementById("videoModal");const modalClose=document.getElementById("modalClose");const modalVideoContainer=document.getElementById("modalVideoContainer");let activeVideo=null;let currentVideoId=null;if(!videoWrappers.length||!videoModal||!modalClose||!modalVideoContainer)return;const lazyLoadThumbnails=()=>{videoWrappers.forEach(wrapper=>{const videoId=wrapper.dataset.videoId;if(!videoId)return;const img=new Image;img.onload=()=>{wrapper.style.backgroundImage=`url('https://fast.wistia.com/embed/medias/${videoId}/swatch')`};img.src=`https://fast.wistia.com/embed/medias/${videoId}/swatch`;wrapper.addEventListener("click",()=>{openVideoModal(videoId)})})};setTimeout(lazyLoadThumbnails,1e3);function openVideoModal(videoId){modalVideoContainer.innerHTML=`<div class="wistia_embed wistia_async_${videoId}" style="height:100%;width:100%"></div>`;videoModal.classList.add("active");document.body.style.overflow="hidden";currentVideoId=videoId;window.modalManager.openModal(`video-${videoId}`,videoModal,closeVideoModal);if(typeof window._wq==="undefined"){loadWistia()}window._wq=window._wq||[];_wq.push({id:videoId,onReady:function(video){activeVideo=video;video.play()}});attachSwipeToClose(videoModal,function(){window.modalManager.closeModal(`video-${videoId}`)})}function closeVideoModal(){if(activeVideo){activeVideo.pause()}videoModal.classList.remove("active");document.body.style.overflow="";setTimeout(()=>{modalVideoContainer.innerHTML="";activeVideo=null},300)}modalClose.addEventListener("click",()=>{if(currentVideoId){window.modalManager.closeModal(`video-${currentVideoId}`)}});videoModal.addEventListener("click",e=>{if(e.target===videoModal&&currentVideoId){window.modalManager.closeModal(`video-${currentVideoId}`)}});document.addEventListener("keydown",e=>{if(e.key==="Escape"&&videoModal.classList.contains("active")&&currentVideoId){window.modalManager.closeModal(`video-${currentVideoId}`)}})},"important");function attachSwipeToClose(element,closeCallback){if(!("ontouchstart"in window))return;let touchStartX=0;let touchEndX=0;const swipeThreshold=100;element.addEventListener("touchstart",function(e){touchStartX=e.changedTouches[0].screenX},{passive:true});element.addEventListener("touchend",function(e){touchEndX=e.changedTouches[0].screenX;handleSwipe()},{passive:true});function handleSwipe(){const swipeDistance=touchEndX-touchStartX;if(swipeDistance<-swipeThreshold){closeCallback()}}}